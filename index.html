<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Meal Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    textarea, input { width: 100%; padding: 8px; margin: 5px 0; }
    button { padding: 10px 15px; margin-top: 10px; cursor: pointer; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: left; }
    .modal {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.6);
      justify-content: center; align-items: center;
    }
    .modal-content {
      background: #fff; padding: 20px; border-radius: 5px;
      width: 300px;
    }
  </style>
</head>
<body>
  <h2>üçΩÔ∏è Simple Meal Tracker</h2>

  <textarea id="mealInput" rows="4" placeholder="e.g. 2 roti + 1 boiled egg + 1 banana"></textarea>
  <button onclick="calculateNutrition()">Calculate Nutrition</button>
  <button onclick="openAddModal()">‚ûï Add New Food Item</button>

  <div id="results"></div>

  <!-- Add Food Modal -->
  <div id="addModal" class="modal">
    <div class="modal-content">
      <h3>Add Custom Food</h3>
      <input id="foodName" placeholder="e.g. Paneer bhurji" />
      <input type="number" id="proteinVal" placeholder="Protein (g)" />
      <input type="number" id="carbsVal" placeholder="Carbs (g)" />
      <input type="number" id="fatVal" placeholder="Fat (g)" />
      <button onclick="saveCustomFood()">Save</button>
      <button onclick="closeAddModal()">Cancel</button>
    </div>
  </div>

  <script>
    let foodDB = {
      banana: { protein: 1.3, carbs: 27, fat: 0.3 },
      "boiled egg": { protein: 6, carbs: 0.6, fat: 5 },
      roti: { protein: 2.5, carbs: 18, fat: 0.4 },
      rice: { protein: 2.7, carbs: 28, fat: 0.3 }
    };

    const savedFoods = JSON.parse(localStorage.getItem("customFoods"));
    if (savedFoods) {
      foodDB = { ...foodDB, ...savedFoods };
    }

    function calculateNutrition() {
      const input = document.getElementById("mealInput").value.toLowerCase();
      let total = { protein: 0, carbs: 0, fat: 0 };

      for (let item in foodDB) {
        const regex = new RegExp(`(\\d*)\\s*${item}`, "g");
        let match;
        while ((match = regex.exec(input)) !== null) {
          const qty = parseFloat(match[1]) || 1;
          total.protein += foodDB[item].protein * qty;
          total.carbs += foodDB[item].carbs * qty;
          total.fat += foodDB[item].fat * qty;
        }
      }

      document.getElementById("results").innerHTML = `
        <h3>Nutrition Breakdown</h3>
        <table>
          <tr><th>Nutrient</th><th>Amount</th></tr>
          <tr><td>Protein</td><td><b>${total.protein.toFixed(1)} g</b></td></tr>
          <tr><td>Carbohydrates</td><td><b>${total.carbs.toFixed(1)} g</b></td></tr>
          <tr><td>Fat</td><td><b>${total.fat.toFixed(1)} g</b></td></tr>
        </table>
      `;
    }

    function openAddModal() {
      document.getElementById("addModal").style.display = "flex";
    }

    function closeAddModal() {
      document.getElementById("addModal").style.display = "none";
      document.getElementById("foodName").value = "";
      document.getElementById("proteinVal").value = "";
      document.getElementById("carbsVal").value = "";
      document.getElementById("fatVal").value = "";
    }

    function saveCustomFood() {
      const name = document.getElementById("foodName").value.toLowerCase().trim();
      const protein = parseFloat(document.getElementById("proteinVal").value);
      const carbs = parseFloat(document.getElementById("carbsVal").value);
      const fat = parseFloat(document.getElementById("fatVal").value);

      if (!name || isNaN(protein) || isNaN(carbs) || isNaN(fat)) {
        alert("Please fill in all fields correctly."
